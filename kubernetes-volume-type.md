# انواع PersistentVolume در کوبرنتیس

در این مستند، انواع مختلف **PersistentVolume** (حجم‌های پایدار) در کوبرنتیس توضیح داده شده‌اند. هر نوع با یک مثال عملی و سناریوی استفاده شرح داده شده است تا درک بهتری از کاربرد آن‌ها در محیط‌های واقعی فراهم شود.

## 1. CSI (Container Storage Interface)
**توضیح**: رابط ذخیره‌سازی کانتینری (CSI) یک استاندارد برای اتصال کوبرنتیس به سیستم‌های ذخیره‌سازی مختلف است. این افزونه امکان استفاده از ذخیره‌سازهای ابری (مانند AWS EBS) یا داخلی (مانند Ceph) را فراهم می‌کند. CSI به دلیل انعطاف‌پذیری و پشتیبانی گسترده، برای محیط‌های ابری و پیشرفته مناسب است.

**مثال**: یک برنامه وب با پایگاه داده MySQL روی AWS اجرا می‌شود و داده‌ها روی دیسک AWS EBS ذخیره می‌شوند.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: mysql-pv
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteOnce
  csi:
    driver: ebs.csi.aws.com
    volumeHandle: vol-1234567890abcdef0
```

**توضیح مثال**:
- `driver: ebs.csi.aws.com`: افزونه CSI مربوط به AWS EBS.
- `volumeHandle`: شناسه دیسک در AWS.
- این حجم برای ذخیره داده‌های MySQL در محیط ابری استفاده می‌شود.

**کاربرد**: محیط‌های ابری یا ذخیره‌سازهای پیشرفته با نیاز به مقیاس‌پذیری.

## 2. FC (Fibre Channel)
**توضیح**: این نوع برای اتصال به دستگاه‌های ذخیره‌سازی مبتنی بر فیبر نوری (Fibre Channel) در مراکز داده سازمانی استفاده می‌شود. مناسب برای برنامه‌هایی با نیاز به سرعت بالا و تأخیر کم.

**مثال**: یک شرکت مالی داده‌های تراکنش‌ها را روی دستگاه ذخیره‌سازی SAN با فیبر نوری ذخیره می‌کند.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: fc-pv
spec:
  capacity:
    storage: 20Gi
  accessModes:
    - ReadWriteOnce
  fc:
    targetWWNs: ["500a0981891b8c1c"]
    lun: 0
    readOnly: false
```

**توضیح مثال**:
- `targetWWNs`: آدرس دستگاه ذخیره‌سازی فیبر نوری.
- `lun`: شماره واحد منطقی در دستگاه.
- این حجم برای ذخیره داده‌های تراکنش‌های مالی با عملکرد بالا استفاده می‌شود.

**کاربرد**: محیط‌های سازمانی با ذخیره‌سازهای SAN.

## 3. hostPath
**توضیح**: این نوع از یک مسیر در سیستم فایل نود محلی استفاده می‌کند. فقط برای تست‌های تک‌نودی مناسب است و در خوشه‌های چندنودی توصیه نمی‌شود.

**مثال**: یک توسعه‌دهنده در حال تست برنامه‌ای روی خوشه تک‌نودی است و داده‌های موقتی را در یک پوشه محلی ذخیره می‌کند.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: hostpath-pv
spec:
  capacity:
    storage: 5Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: "/mnt/data"
    type: DirectoryOrCreate
```

**توضیح مثال**:
- `path: "/mnt/data"`: پوشه‌ای روی نود برای ذخیره داده‌ها.
- `type: DirectoryOrCreate`: اگر پوشه وجود نداشته باشد، ایجاد می‌شود.
- این حجم برای ذخیره لاگ‌ها یا فایل‌های موقتی در تست استفاده می‌شود.

**کاربرد**: تست‌های اولیه یا محیط‌های غیرحیاتی.

## 4. iSCSI (SCSI over IP)
**توضیح**: iSCSI امکان اتصال به ذخیره‌سازهای SAN از طریق شبکه IP را فراهم می‌کند. مناسب برای ذخیره‌سازی متمرکز در شبکه.

**مثال**: یک شرکت از سرور iSCSI برای ذخیره داده‌های یک برنامه وب استفاده می‌کند.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: iscsi-pv
spec:
  capacity:
    storage: 15Gi
  accessModes:
    - ReadWriteOnce
  iscsi:
    targetPortal: "10.0.0.1:3260"
    iqn: "iqn.2003-01.org.linux-iscsi.target1.x8664:sn.123456789"
    lun: 1
    fsType: "ext4"
```

**توضیح مثال**:
- `targetPortal`: آدرس و پورت سرور iSCSI.
- `iqn`: شناسه یکتای دستگاه ذخیره‌سازی.
- این حجم برای ذخیره داده‌های برنامه وب با دسترسی متمرکز استفاده می‌شود.

**کاربرد**: محیط‌های داخلی با ذخیره‌سازهای SAN.

## 5. Local
**توضیح**: این نوع به دیسک‌های ذخیره‌سازی محلی (مانند SSD یا HDD) روی نودها اشاره دارد. برای خوشه‌های چندنودی با نیاز به عملکرد بالا مناسب است.

**مثال**: یک پایگاه داده MongoDB روی دیسک SSD محلی برای عملکرد بالا اجرا می‌شود.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: local-pv
spec:
  capacity:
    storage: 50Gi
  accessModes:
    - ReadWriteOnce
  local:
    path: "/mnt/ssd1"
  nodeAffinity:
    required:
      nodeSelectorTerms:
      - matchExpressions:
        - key: kubernetes.io/hostname
          operator: In
          values:
          - node1
```

**توضیح مثال**:
- `path: "/mnt/ssd1"`: دیسک SSD روی نود.
- `nodeAffinity`: حجم فقط به Podهای روی نود `node1` اختصاص می‌یابد.
- این حجم برای اجرای MongoDB با تأخیر کم استفاده می‌شود.

**کاربرد**: برنامه‌های با نیاز به دسترسی سریع به ذخیره‌سازی محلی.

## 6. NFS (Network File System)
**توضیح**: NFS یک سیستم فایل شبکه‌ای برای اشتراک‌گذاری داده‌ها بین چندین Pod است. مناسب برای دسترسی همزمان به داده‌های مشترک.

**مثال**: چندین Pod یک برنامه وردپرس به یک پوشه مشترک برای فایل‌های رسانه‌ای دسترسی دارند.

**پیکربندی نمونه**:
```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: nfs-pv
spec:
  capacity:
    storage: 10Gi
  accessModes:
    - ReadWriteMany
  nfs:
    server: "192.168.1.100"
    path: "/exports"
```

**توضیح مثال**:
- `server: "192.168.1.100"`: آدرس سرور NFS.
- `path: "/exports"`: پوشه اشتراک‌گذاری‌شده.
- `ReadWriteMany`: امکان دسترسی همزمان چند Pod.
- این حجم برای ذخیره فایل‌های رسانه‌ای وردپرس استفاده می‌شود.

**کاربرد**: اشتراک‌گذاری داده‌ها بین چندین Pod یا نود.

## جمع‌بندی
- **CSI**: برای محیط‌های ابری (مثال: MySQL با AWS EBS).
- **FC**: برای ذخیره‌سازی سازمانی (مثال: تراکنش‌های مالی).
- **hostPath**: برای تست تک‌نودی (مثال: لاگ‌های موقتی).
- **iSCSI**: برای ذخیره‌سازی متمرکز (مثال: برنامه وب با SAN).
- **Local**: برای ذخیره‌سازی محلی با عملکرد بالا (مثال: MongoDB روی SSD).
- **NFS**: برای اشتراک‌گذاری داده‌ها (مثال: فایل‌های وردپرس).

برای اطلاعات بیشتر یا پیاده‌سازی عملی، به مستندات رسمی کوبرنتیس مراجعه کنید.
